<html xmlns="http://www.w3.org/1999/xhtml">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
</head>
<script src="https://unpkg.com/vue/dist/vue.js"></script>
<script src="https://unpkg.com/element-ui@2.3.4/lib/index.js"></script>
<script src="md5.min.js"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>

<body>
  <div id="app" style="width: 50%;margin: 0 auto; text-align: center">
    <el-form ref="form" :model="form" label-width="80px">
      <el-form-item label="用户ID">
        <el-input v-model="form.usename"></el-input>
      </el-form-item>
      <el-form-item label="密码">
        <el-input type="password" v-model="form.password"></el-input>
      </el-form-item>
      <el-form-item label="md5密码">
        <div>"{{md5Password}}"</div>
      </el-form-item>
      <el-form-item>
        <el-button type="primary " @click="onSubmit ">登录</el-button>
        <el-button>取消</el-button>
      </el-form-item>
    </el-form>
  </div>
</body>
<script>

  var Main = {
    data() {
      return {
        form: {
          usename: '',
          password: '',
        },
      }
    },
    methods: {
      onSubmit() {
        var that = this;
        axios({
          url: '/weapp/WebLogin',
          //url: '/weapp/index.php/WebLogin',
          method: 'post',
          data: {
            userId: this.form.usename-6000,
            password: this.md5Password
          },
          transformRequest: [function (data) {
            // Do whatever you want to transform the data
            let ret = ''
            for (let it in data) {
              ret += encodeURIComponent(it) + '=' + encodeURIComponent(data[it]) + '&'
            }
            return ret
          }],
          headers: {
            'Content-Type': 'application/x-www-form-urlencoded'
          }
        })
          .then(function (response) {

            //var res = JSON.parse(response);
            console.log(response.data.code);
            if (response.data.code === 0) {
              //window.location="/server/login.php";
              sessionStorage.userId = that.form.usename-6000;
              window.location = "activity_list.html";
            }

          })
          .catch(function (error) {
            console.log(error);
          });
        /*var delta = quill.getContents();
        console.log('delta!' + delta);
        var txt = quill.getText();
        console.log('txt!' + txt);
        */

      },
    },
    computed: {
      md5Password() {
        return md5(this.form.password);
      }
    },
  }

  var Ctor = Vue.extend(Main)
  new Ctor().$mount('#app')
</script>

</html>